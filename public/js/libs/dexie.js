!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Dexie=t()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.
    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.
    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var e=function(){return e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},e.apply(this,arguments)};function t(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,r=Object.keys,i=Array.isArray;function o(e,t){return"object"!=typeof t||r(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||n.Promise||(n.Promise=Promise);var u=Object.getPrototypeOf,a={}.hasOwnProperty;function s(e,t){return a.call(e,t)}function c(e,t){"function"==typeof t&&(t=t(u(e))),("undefined"==typeof Reflect?r:Reflect.ownKeys)(t).forEach((function(n){f(e,n,t[n])}))}var l=Object.defineProperty;function f(e,t,n,r){l(e,t,o(n&&s(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function h(e){return{from:function(t){return e.prototype=Object.create(t.prototype),f(e.prototype,"constructor",e),{extend:c.bind(null,e.prototype)}}}}var d=Object.getOwnPropertyDescriptor;function p(e,t){var n;return d(e,t)||(n=u(e))&&p(n,t)}var y=[].slice;function v(e,t,n){return y.call(e,t,n)}function m(e,t){return t(e)}function g(e){if(!e)throw new Error("Assertion Failed")}function b(e){n.setImmediate?setImmediate(e):setTimeout(e,0)}function _(e,t){return e.reduce((function(e,n,r){var i=t(n,r);return i&&(e[i[0]]=i[1]),e}),{})}function w(e,t){if(s(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=w(e,t[r]);n.push(o)}return n}var u=t.indexOf(".");if(-1!==u){var a=e[t.substr(0,u)];return void 0===a?void 0:w(a,t.substr(u+1))}}function x(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){g("string"!=typeof n&&"length"in n);for(var r=0,o=t.length;r<o;++r)x(e,t[r],n[r])}else{var u=t.indexOf(".");if(-1!==u){var a=t.substr(0,u),c=t.substr(u+1);if(""===c)void 0===n?i(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n;else{var l=e[a];l&&s(e,a)||(l=e[a]={}),x(l,c,n)}}else void 0===n?i(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function k(e){var t={};for(var n in e)s(e,n)&&(t[n]=e[n]);return t}var E=[].concat;function P(e){return E.apply([],e)}var K="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(P([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return n[e]})),O=K.map((function(e){return n[e]}));_(K,(function(e){return[e,!0]}));var S=null;function A(e){S="undefined"!=typeof WeakMap&&new WeakMap;var t=C(e);return S=null,t}function C(e){if(!e||"object"!=typeof e)return e;var t=S&&S.get(e);if(t)return t;if(i(e)){t=[],S&&S.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(C(e[n]))}else if(O.indexOf(e.constructor)>=0)t=e;else{var o=u(e);for(var a in t=o===Object.prototype?{}:Object.create(o),S&&S.set(e,t),e)s(e,a)&&(t[a]=C(e[a]))}return t}var j={}.toString;function D(e){return j.call(e).slice(8,-1)}var I="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",B="symbol"==typeof I?function(e){var t;return null!=e&&(t=e[I])&&t.apply(e)}:function(){return null},T={};function R(e){var t,n,r,o;if(1===arguments.length){if(i(e))return e.slice();if(this===T&&"string"==typeof e)return[e];if(o=B(e)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var F="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},M="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function N(e,t){M=e,q=t}var q=function(){return!0},L=!new Error("").stack;function U(){if(L)try{throw U.arguments,new Error}catch(e){return e}return new Error}function V(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(q).map((function(e){return"\n"+e})).join("")):""}var W=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],z=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(W),Y={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function G(e,t){this._e=U(),this.name=e,this.message=t}function H(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function Q(e,t,n,r){this._e=U(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=H(e,t)}function X(e,t){this._e=U(),this.name="BulkError",this.failures=Object.keys(t).map((function(e){return t[e]})),this.failuresByPos=t,this.message=H(e,t)}h(G).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+V(this._e,2))}},toString:function(){return this.name+": "+this.message}}),h(Q).from(G),h(X).from(G);var J=z.reduce((function(e,t){return e[t]=t+"Error",e}),{}),$=G,Z=z.reduce((function(e,t){var n=t+"Error";function r(e,r){this._e=U(),this.name=n,e?"string"==typeof e?(this.message=e+(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=Y[t]||n,this.inner=null)}return h(r).from($),e[t]=r,e}),{});Z.Syntax=SyntaxError,Z.Type=TypeError,Z.Range=RangeError;var ee=W.reduce((function(e,t){return e[t+"Error"]=Z[t],e}),{});var te=z.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=Z[t]),e}),{});function ne(){}function re(e){return e}function ie(e,t){return null==e||e===re?t:function(n){return t(e(n))}}function oe(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ue(e,t){return e===ne?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?oe(r,this.onsuccess):r),i&&(this.onerror=this.onerror?oe(i,this.onerror):i),void 0!==o?o:n}}function ae(e,t){return e===ne?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?oe(n,this.onsuccess):n),r&&(this.onerror=this.onerror?oe(r,this.onerror):r)}}function se(e,t){return e===ne?t:function(n){var r=e.apply(this,arguments);o(n,r);var i=this.onsuccess,u=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?oe(i,this.onsuccess):i),u&&(this.onerror=this.onerror?oe(u,this.onerror):u),void 0===r?void 0===a?void 0:a:o(r,a)}}function ce(e,t){return e===ne?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function le(e,t){return e===ne?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}te.ModifyError=Q,te.DexieError=G,te.BulkError=X;var fe={},he="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,u(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,u(t),e]}(),de=he[0],pe=he[1],ye=he[2],ve=pe&&pe.then,me=de&&de.constructor,ge=!!ye,be=!1,_e=ye?function(){ye.then(Ve)}:n.setImmediate?setImmediate.bind(null,Ve):n.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){Ve(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Ve,0)},we=function(e,t){Ce.push([e,t]),ke&&(_e(),ke=!1)},xe=!0,ke=!0,Ee=[],Pe=[],Ke=null,Oe=re,Se={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:pt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{pt(e[0],e[1])}catch(e){}}))}},Ae=Se,Ce=[],je=0,De=[];function Ie(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ne,this._lib=!1;var t=this._PSD=Ae;if(M&&(this._stackHolder=U(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==fe)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Fe(this,this._value))}this._state=null,this._value=null,++t.ref,Re(this,e)}var Be={get:function(){var e=Ae,t=Ze;function n(n,r){var i=this,o=!e.global&&(e!==Ae||t!==Ze),u=o&&!rt(),a=new Ie((function(t,a){Ne(i,new Te(ft(n,e,o,u),ft(r,e,o,u),t,a,e))}));return M&&Ue(a,this),a}return n.prototype=fe,n},set:function(e){f(this,"then",e&&e.prototype===fe?Be:{get:function(){return e},set:Be.set})}};function Te(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function Re(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&We();t&&"function"==typeof t.then?Re(e,(function(e,n){t instanceof Ie?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Me(e)),n&&ze()}}),Fe.bind(null,e))}catch(t){Fe(e,t)}}function Fe(e,t){if(Pe.push(t),null===e._state){var n=e._lib&&We();t=Oe(t),e._state=!1,e._value=t,M&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}((function(){var n=p(t,"stack");t._promise=e,f(t,"stack",{get:function(){return be?n&&(n.get?n.get.apply(t):n.value):e.stack}})})),function(e){Ee.some((function(t){return t._value===e._value}))||Ee.push(e)}(e),Me(e),n&&ze()}}function Me(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ne(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===je&&(++je,we((function(){0==--je&&Ye()}),[]))}function Ne(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++je,we(qe,[n,e,t])}else e._listeners.push(t)}function qe(e,t,n){try{Ke=t;var r,i=t._value;t._state?r=e(i):(Pe.length&&(Pe=[]),r=e(i),-1===Pe.indexOf(i)&&function(e){var t=Ee.length;for(;t;)if(Ee[--t]._value===e._value)return void Ee.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{Ke=null,0==--je&&Ye(),--n.psd.ref||n.psd.finalize()}}function Le(e,t,n){if(t.length===n)return t;var r="";if(!1===e._state){var i,o,u=e._value;null!=u?(i=u.name||"Error",o=u.message||u,r=V(u,0)):(i=u,o=""),t.push(i+(o?": "+o:"")+r)}return M&&((r=V(e._stackHolder,2))&&-1===t.indexOf(r)&&t.push(r),e._prev&&Le(e._prev,t,n)),t}function Ue(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function Ve(){We()&&ze()}function We(){var e=xe;return xe=!1,ke=!1,e}function ze(){var e,t,n;do{for(;Ce.length>0;)for(e=Ce,Ce=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Ce.length>0);xe=!0,ke=!0}function Ye(){var e=Ee;Ee=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=De.slice(0),n=t.length;n;)t[--n]()}function Ge(e){return new Ie(fe,!1,e)}function He(e,t){var n=Ae;return function(){var r=We(),i=Ae;try{return at(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{at(i,!1),r&&ze()}}}c(Ie.prototype,{then:Be,_then:function(e,t){Ne(this,new Te(null,null,e,t,Ae))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?n(e):Ge(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):Ge(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),Ge(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{be=!0;var e=Le(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{be=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Ie((function(r,i){var o=setTimeout((function(){return i(new Z.Timeout(t))}),e);n.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&f(Ie.prototype,Symbol.toStringTag,"Dexie.Promise"),Se.env=st(),c(Ie,{all:function(){var e=R.apply(null,arguments).map(it);return new Ie((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(i,o){return Ie.resolve(i).then((function(n){e[o]=n,--r||t(e)}),n)}))}))},resolve:function(e){if(e instanceof Ie)return e;if(e&&"function"==typeof e.then)return new Ie((function(t,n){e.then(t,n)}));var t=new Ie(fe,!0,e);return Ue(t,Ke),t},reject:Ge,race:function(){var e=R.apply(null,arguments).map(it);return new Ie((function(t,n){e.map((function(e){return Ie.resolve(e).then(t,n)}))}))},PSD:{get:function(){return Ae},set:function(e){return Ae=e}},totalEchoes:{get:function(){return Ze}},newPSD:tt,usePSD:ct,scheduler:{get:function(){return we},set:function(e){we=e}},rejectionMapper:{get:function(){return Oe},set:function(e){Oe=e}},follow:function(e,t){return new Ie((function(n,r){return tt((function(t,n){var r=Ae;r.unhandleds=[],r.onunhandled=n,r.finalize=oe((function(){var e=this;!function(e){function t(){e(),De.splice(De.indexOf(t),1)}De.push(t),++je,we((function(){0==--je&&Ye()}),[])}((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),me&&(me.allSettled&&f(Ie,"allSettled",(function(){var e=R.apply(null,arguments).map(it);return new Ie((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,i){return Ie.resolve(e).then((function(e){return r[i]={status:"fulfilled",value:e}}),(function(e){return r[i]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),me.any&&"undefined"!=typeof AggregateError&&f(Ie,"any",(function(){var e=R.apply(null,arguments).map(it);return new Ie((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach((function(e,o){return Ie.resolve(e).then((function(e){return t(e)}),(function(e){i[o]=e,--r||n(new AggregateError(i))}))}))}))})));var Qe={awaits:0,echoes:0,id:0},Xe=0,Je=[],$e=0,Ze=0,et=0;function tt(e,t,n,r){var i=Ae,u=Object.create(i);u.parent=i,u.ref=0,u.global=!1,u.id=++et;var a=Se.env;u.env=ge?{Promise:Ie,PromiseProp:{value:Ie,configurable:!0,writable:!0},all:Ie.all,race:Ie.race,allSettled:Ie.allSettled,any:Ie.any,resolve:Ie.resolve,reject:Ie.reject,nthen:ht(a.nthen,u),gthen:ht(a.gthen,u)}:{},t&&o(u,t),++i.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=ct(u,e,n,r);return 0===u.ref&&u.finalize(),s}function nt(){return Qe.id||(Qe.id=++Xe),++Qe.awaits,Qe.echoes+=100,Qe.id}function rt(){return!!Qe.awaits&&(0==--Qe.awaits&&(Qe.id=0),Qe.echoes=100*Qe.awaits,!0)}function it(e){return Qe.echoes&&e&&e.constructor===me?(nt(),e.then((function(e){return rt(),e}),(function(e){return rt(),yt(e)}))):e}function ot(e){++Ze,Qe.echoes&&0!=--Qe.echoes||(Qe.echoes=Qe.id=0),Je.push(Ae),at(e,!0)}function ut(){var e=Je[Je.length-1];Je.pop(),at(e,!1)}function at(e,t){var r=Ae;if((t?!Qe.echoes||$e++&&e===Ae:!$e||--$e&&e===Ae)||lt(t?ot.bind(null,e):ut),e!==Ae&&(Ae=e,r===Se&&(Se.env=st()),ge)){var i=Se.env.Promise,o=e.env;pe.then=o.nthen,i.prototype.then=o.gthen,(r.global||e.global)&&(Object.defineProperty(n,"Promise",o.PromiseProp),i.all=o.all,i.race=o.race,i.resolve=o.resolve,i.reject=o.reject,o.allSettled&&(i.allSettled=o.allSettled),o.any&&(i.any=o.any))}}function st(){var e=n.Promise;return ge?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(n,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:pe.then,gthen:e.prototype.then}:{}}function ct(e,t,n,r,i){var o=Ae;try{return at(e,!0),t(n,r,i)}finally{at(o,!1)}}function lt(e){ve.call(de,e)}function ft(e,t,n,r){return"function"!=typeof e?e:function(){var i=Ae;n&&nt(),at(t,!0);try{return e.apply(this,arguments)}finally{at(i,!1),r&&lt(rt)}}}function ht(e,t){return function(n,r){return e.call(this,ft(n,t),ft(r,t))}}-1===(""+ve).indexOf("[native code]")&&(nt=rt=ne);var dt="unhandledrejection";function pt(e,t){var r;try{r=t.onuncatched(e)}catch(e){}if(!1!==r)try{var i,u={promise:t,reason:e};if(n.document&&document.createEvent?((i=document.createEvent("Event")).initEvent(dt,!0,!0),o(i,u)):n.CustomEvent&&o(i=new CustomEvent(dt,{detail:u}),u),i&&n.dispatchEvent&&(dispatchEvent(i),!n.PromiseRejectionEvent&&n.onunhandledrejection))try{n.onunhandledrejection(i)}catch(e){}M&&i&&i.defaultPrevented}catch(e){}}var yt=Ie.reject;function vt(e,t,n,r){if(e.idbdb&&(e._state.openComplete||Ae.letThrough||e._vip)){var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===J.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(e._close(),e.open().then((function(){return vt(e,t,n,r)}))):yt(i)}return i._promise(t,(function(e,t){return tt((function(){return Ae.trans=i,r(e,t,i)}))})).then((function(e){return i._completion.then((function(){return e}))}))}if(e._state.openComplete)return yt(new Z.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return yt(new Z.DatabaseClosed);e.open().catch(ne)}return e._state.dbReadyPromise.then((function(){return vt(e,t,n,r)}))}var mt="3.2.4",gt=String.fromCharCode(65535),bt=-1/0,_t="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",wt="String expected.",xt=[],kt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Et=kt,Pt=kt,Kt=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)},Ot="__dbnames",St="readonly",At="readwrite";function Ct(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var jt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Dt(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=A(t))[e],t}}var It=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||Ae.trans,i=this.name;function o(e,n,r){if(!r.schema[i])throw new Z.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var u=We();try{return r&&r.db===this.db?r===Ae.trans?r._promise(e,o,n):tt((function(){return r._promise(e,o,n)}),{trans:r,transless:Ae.transless||Ae}):vt(this.db,e,[this.name],o)}finally{u&&ze()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(i(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var t=r(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))&&e.keyPath.every((function(e){return t.indexOf(e)>=0}))}))[0];if(n&&this.db._maxKey!==gt)return this.where(n.name).equals(n.keyPath.map((function(t){return e[t]})));var o=this.schema.idxByName,u=this.db._deps.indexedDB;function a(e,t){try{return 0===u.cmp(e,t)}catch(e){return!1}}var s=t.reduce((function(t,n){var r=t[0],u=t[1],s=o[n],c=e[n];return[r||s,r||!s?Ct(u,s&&s.multi?function(e){var t=w(e,n);return i(t)&&t.some((function(e){return a(c,e)}))}:function(e){return a(c,w(e,n))}):u]}),[null,null]),c=s[0],l=s[1];return c?this.where(c.name).equals(e[c.keyPath]).filter(l):n?this.filter(l):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,i(e)?"["+e.join("+")+"]":e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){this.schema.mappedClass=e;var t=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(s(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e},e.prototype.defineClass=function(){return this.mapToClass((function(e){o(this,e)}))},e.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,u=e;return o&&i&&(u=Dt(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[u]})})).then((function(e){return e.numFailures?Ie.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{x(e,o,t)}catch(e){}return t}))},e.prototype.update=function(e,t){if("object"!=typeof e||i(e))return this.where(":id").equals(e).modify(t);var n=w(e,this.schema.primKey.keyPath);if(void 0===n)return yt(new Z.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof t?r(t).forEach((function(n){x(e,n,t[n])})):t(e,{value:e,primKey:n})}catch(e){}return this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,u=e;return o&&i&&(u=Dt(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"put",values:[u],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Ie.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{x(e,o,t)}catch(e){}return t}))},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Ie.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:jt})})).then((function(e){return e.numFailures?Ie.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,u=n.auto,a=n.keyPath;if(a&&i)throw new Z.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=a&&u?e.map(Dt(a)):e;return r.core.mutate({trans:t,type:"add",keys:i,values:c,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult,u=e.failures;if(0===t)return o?n:i;throw new X(r.name+".bulkAdd(): "+t+" of "+s+" operations failed",u)}))}))},e.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,u=n.auto,a=n.keyPath;if(a&&i)throw new Z.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=a&&u?e.map(Dt(a)):e;return r.core.mutate({trans:t,type:"put",keys:i,values:c,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult,u=e.failures;if(0===t)return o?n:i;throw new X(r.name+".bulkPut(): "+t+" of "+s+" operations failed",u)}))}))},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new X(t.name+".bulkDelete(): "+r+" of "+n+" operations failed",o)}))},e}();function Bt(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};n.addEventType=a;for(var o=1,u=arguments.length;o<u;++o)a(arguments[o]);return n;function a(e,r,i){if("object"==typeof e)return s(e);r||(r=ce),i||(i=ne);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter((function(t){return t!==e})),o.fire=o.subscribers.reduce(r,i)}};return t[e]=n[e]=o,o}function s(e){r(e).forEach((function(t){var n=e[t];if(i(n))a(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new Z.InvalidArgument("Invalid event config");var r=a(t,re,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){b((function(){e.apply(null,t)}))}))}))}}))}}function Tt(e,t){return h(t).from({prototype:e}),t}function Rt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Ft(e,t){e.filter=Ct(e.filter,t)}function Mt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Ct(r(),t())}:t,e.justLimit=n&&!r}function Nt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new Z.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function qt(e,t,n){var r=Nt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Lt(e,t,n,r){var i=e.replayFilter?Ct(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},u=function(e,n,r){if(!i||i(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var u=n.primaryKey,a=""+u;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(u)),s(o,a)||(o[a]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(u,n),Ut(qt(e,r,n),e.algorithm,u,!e.keysOnly&&e.valueMapper)])}return Ut(qt(e,r,n),Ct(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Ut(e,t,n,r){var i=He(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=ne}),(function(t){e.fail(t),n=ne}))||i(e.value,e,(function(e){return n=e})),n()}))}))}function Vt(e,t){try{var n=Wt(e),r=Wt(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return n===r?0:n<r?-1:1}(zt(e),zt(t));case"Array":return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o){var u=Vt(e[o],t[o]);if(0!==u)return u}return n===r?0:n<r?-1:1}(e,t)}}catch(e){}return NaN}function Wt(e){var t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";var n=D(e);return"ArrayBuffer"===n?"binary":n}function zt(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Yt=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,yt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,yt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Ct(t.algorithm,e)},e.prototype._iterate=function(e,t){return Lt(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&o(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return Lt(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(Rt(n,!0))return r.count({trans:e,query:{index:Nt(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var i=0;return Lt(n,(function(){return++i,!1}),e,r).then((function(){return i}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var u="next"===this._ctx.dir?1:-1;function a(e,t){var n=o(e,i),r=o(t,i);return n<r?-u:n>r?u:0}return this.toArray((function(e){return e.sort(a)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&Rt(n,!0)&&n.limit>0){var r=n.valueMapper,i=Nt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var o=[];return Lt(n,(function(e){return o.push(e)}),e,n.table.core).then((function(){return o}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Rt(t)?Mt(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):Mt(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Mt(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return Ft(this._ctx,(function(n,r,i){return!e(n.value)||(r(i),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){var t,n;return Ft(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=Ct(t.isMatch,n),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&Rt(t,!0)&&t.limit>0)return this._read((function(e){var n=Nt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Ft(this._ctx,(function(e){var t=e.primaryKey.toString(),r=s(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(i){var o;if("function"==typeof e)o=e;else{var u=r(e),a=u.length;o=function(t){for(var n=!1,r=0;r<a;++r){var i=u[r],o=e[i];w(t,i)!==o&&(x(t,i,o),n=!0)}return n}}var s=n.table.core,c=s.schema.primaryKey,l=c.outbound,f=c.extractKey,h=t.db._options.modifyChunkSize||200,d=[],p=0,y=[],v=function(e,t){var n=t.failures,i=t.numFailures;p+=e-i;for(var o=0,u=r(n);o<u.length;o++){var a=u[o];d.push(n[a])}};return t.clone().primaryKeys().then((function(t){var r=function(u){var a=Math.min(h,t.length-u);return s.getMany({trans:i,keys:t.slice(u,u+a),cache:"immutable"}).then((function(c){for(var d=[],p=[],y=l?[]:null,m=[],g=0;g<a;++g){var b=c[g],_={value:A(b),primKey:t[u+g]};!1!==o.call(_,_.value,_)&&(null==_.value?m.push(t[u+g]):l||0===Vt(f(b),f(_.value))?(p.push(_.value),l&&y.push(t[u+g])):(m.push(t[u+g]),d.push(_.value)))}var w=Rt(n)&&n.limit===1/0&&("function"!=typeof e||e===Gt)&&{index:n.index,range:n.range};return Promise.resolve(d.length>0&&s.mutate({trans:i,type:"add",values:d}).then((function(e){for(var t in e.failures)m.splice(parseInt(t),1);v(d.length,e)}))).then((function(){return(p.length>0||w&&"object"==typeof e)&&s.mutate({trans:i,type:"put",keys:y,values:p,criteria:w,changeSpec:"function"!=typeof e&&e}).then((function(e){return v(p.length,e)}))})).then((function(){return(m.length>0||w&&e===Gt)&&s.mutate({trans:i,type:"delete",keys:m,criteria:w}).then((function(e){return v(m.length,e)}))})).then((function(){return t.length>u+a&&r(u+h)}))}))};return r(0).then((function(){if(d.length>0)throw new Q("Error modifying one or more objects",d,p,y);return t.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return Rt(e)&&(e.isPrimKey&&!Pt||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then((function(e){var n=e.failures;e.lastResult,e.results;var r=e.numFailures;if(r)throw new Q("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify(Gt)},e}(),Gt=function(e,t){return t.value=null};function Ht(e,t){return e<t?-1:e===t?0:1}function Qt(e,t){return e>t?-1:e===t?0:1}function Xt(e,t,n){var r=e instanceof nn?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Jt(e){return new e.Collection(e,(function(){return tn("")})).limit(0)}function $t(e,t,n,r,i,o){for(var u=Math.min(e.length,r.length),a=-1,s=0;s<u;++s){var c=t[s];if(c!==r[s])return i(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):a>=0?e.substr(0,a)+t[a]+n.substr(a+1):null;i(e[s],c)<0&&(a=s)}return u<r.length&&"next"===o?e+n.substr(e.length):u<e.length&&"prev"===o?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}function Zt(e,t,n,r){var i,o,u,a,s,c,l,f=n.length;if(!n.every((function(e){return"string"==typeof e})))return Xt(e,wt);function h(e){i=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),o=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),u="next"===e?Ht:Qt;var t=n.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,t){return u(e.lower,t.lower)}));a=t.map((function(e){return e.upper})),s=t.map((function(e){return e.lower})),c=e,l="next"===e?"":r}h("next");var d=new e.Collection(e,(function(){return en(a[0],s[f-1]+r)}));d._ondirectionchange=function(e){h(e)};var p=0;return d._addAlgorithm((function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var h=o(i);if(t(h,s,p))return!0;for(var d=null,y=p;y<f;++y){var v=$t(i,h,a[y],s[y],u,c);null===v&&null===d?p=y+1:(null===d||u(d,v)>0)&&(d=v)}return n(null!==d?function(){e.continue(d+l)}:r),!1})),d}function en(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function tn(e){return{type:1,lower:e,upper:e}}var nn=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Jt(this):new this.Collection(this,(function(){return en(e,t,!n,!r)}))}catch(e){return Xt(this,_t)}},e.prototype.equals=function(e){return null==e?Xt(this,_t):new this.Collection(this,(function(){return tn(e)}))},e.prototype.above=function(e){return null==e?Xt(this,_t):new this.Collection(this,(function(){return en(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?Xt(this,_t):new this.Collection(this,(function(){return en(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?Xt(this,_t):new this.Collection(this,(function(){return en(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?Xt(this,_t):new this.Collection(this,(function(){return en(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?Xt(this,wt):this.between(e,e+gt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Zt(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],gt)},e.prototype.equalsIgnoreCase=function(e){return Zt(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=R.apply(T,arguments);return 0===e.length?Jt(this):Zt(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=R.apply(T,arguments);return 0===e.length?Jt(this):Zt(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,gt)},e.prototype.anyOf=function(){var e=this,t=R.apply(T,arguments),n=this._cmp;try{t.sort(n)}catch(e){return Xt(this,_t)}if(0===t.length)return Jt(this);var r=new this.Collection(this,(function(){return en(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm((function(e,r,o){for(var u=e.key;n(u,t[i])>0;)if(++i===t.length)return r(o),!1;return 0===n(u,t[i])||(r((function(){e.continue(t[i])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[bt,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=R.apply(T,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Xt(this,_t)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[bt,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,o=this._descending,u=this._min,a=this._max;if(0===e.length)return Jt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0})))return Xt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Z.InvalidArgument);var s=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers;var l,f=i;function h(e,t){return f(e[0],t[0])}try{l=e.reduce((function(e,t){for(var n=0,i=e.length;n<i;++n){var o=e[n];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=u(o[0],t[0]),o[1]=a(o[1],t[1]);break}}return n===i&&e.push(t),e}),[]),l.sort(h)}catch(e){return Xt(this,_t)}var d=0,p=c?function(e){return i(e,l[d][1])>0}:function(e){return i(e,l[d][1])>=0},y=s?function(e){return o(e,l[d][0])>0}:function(e){return o(e,l[d][0])>=0};var v=p,m=new this.Collection(this,(function(){return en(l[0][0],l[l.length-1][1],!s,!c)}));return m._ondirectionchange=function(e){"next"===e?(v=p,f=i):(v=y,f=o),l.sort(h)},m._addAlgorithm((function(e,t,r){for(var o=e.key;v(o);)if(++d===l.length)return t(r),!1;return!!function(e){return!p(e)&&!y(e)}(o)||(0===n._cmp(o,l[d][1])||0===n._cmp(o,l[d][0])||t((function(){f===i?e.continue(l[d][0]):e.continue(l[d][1])})),!1)})),m},e.prototype.startsWithAnyOf=function(){var e=R.apply(T,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?Jt(this):this.inAnyRange(e.map((function(e){return[e,e+gt]}))):Xt(this,"startsWithAnyOf() only works with strings")},e}();function rn(e){return He((function(t){return on(t),e(t.target.error),!1}))}function on(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var un="storagemutated",an="x-storagemutated-1",sn=Bt(null,un),cn=function(){function e(){}return e.prototype._lock=function(){return g(!Ae.global),++this._reculock,1!==this._reculock||Ae.global||(Ae.lockOwnerFor=this),this},e.prototype._unlock=function(){if(g(!Ae.global),0==--this._reculock)for(Ae.global||(Ae.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ct(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&Ae.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(g(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new Z.DatabaseClosed(r);case"MissingAPIError":throw new Z.MissingAPI(r.message,r);default:throw new Z.OpenFailed(r)}if(!this.active)throw new Z.TransactionInactive;return g(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=He((function(n){on(n),t._reject(e.error)})),e.onabort=He((function(n){on(n),t.active&&t._reject(new Z.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=He((function(){t.active=!1,t._resolve(),"mutatedParts"in e&&sn.storagemutated.fire(e.mutatedParts)})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return yt(new Z.ReadOnly("Transaction is readonly"));if(!this.active)return yt(new Z.TransactionInactive);if(this._locked())return new Ie((function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},Ae])}));if(n)return tt((function(){var e=new Ie((function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new Ie((function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Ie.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Ie((function(e,r){n.then((function(n){return t._waitingQueue.push(He(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(He(r.bind(null,e)))})).finally((function(){t._waitingFor===i&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Z.Abort))},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(s(t,e))return t[e];var n=this.schema[e];if(!n)throw new Z.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function ln(e,t,n,r,i,o,u){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!u?"&":"")+(r?"*":"")+(i?"++":"")+fn(t)}}function fn(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function hn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:_(n,(function(e){return[e.name,e]}))}}var dn=function(e){try{return e.only([[]]),dn=function(){return[[]]},[[]]}catch(e){return dn=function(){return gt},gt}};function pn(e){return null==e?function(){}:"string"==typeof e?function(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return w(t,e)}}(e):function(t){return w(t,e)}}function yn(e){return[].slice.call(e)}var vn=0;function mn(e){return null==e?":id":"string"==typeof e?e:"["+e.join("+")+"]"}function gn(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen;return void 0===n?void 0===r?null:t.upperBound(r,!!o):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!o)}var o=function(e,t){var n=yn(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=i(t),o=null==t,u={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:o,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:pn(t)},indexes:yn(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,o=e.keyPath,a={name:t,compound:i(o),keyPath:o,unique:n,multiEntry:r,extractKey:pn(o)};return u[mn(o)]=a,a})),getIndexByKeyPath:function(e){return u[mn(e)]}};return u[":id"]=a.primaryKey,null!=t&&(u[mn(t)]=a.primaryKey),a}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),u=o.schema,a=o.hasGetAll,s=u.tables.map((function(e){return function(e){var t=e.name;return{name:t,schema:e,mutate:function(e){var n=e.trans,i=e.type,o=e.keys,u=e.values,a=e.range;return new Promise((function(e,s){e=He(e);var c=n.objectStore(t),l=null==c.keyPath,f="put"===i||"add"===i;if(!f&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var h,d=(o||u||{length:1}).length;if(o&&u&&o.length!==u.length)throw new Error("Given keys array must have same length as given values array.");if(0===d)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var p=[],y=[],v=0,m=function(e){++v,on(e)};if("deleteRange"===i){if(4===a.type)return e({numFailures:v,failures:y,results:[],lastResult:void 0});3===a.type?p.push(h=c.clear()):p.push(h=c.delete(r(a)))}else{var g=f?l?[u,o]:[u,null]:[o,null],b=g[0],_=g[1];if(f)for(var w=0;w<d;++w)p.push(h=_&&void 0!==_[w]?c[i](b[w],_[w]):c[i](b[w])),h.onerror=m;else for(w=0;w<d;++w)p.push(h=c[i](b[w])),h.onerror=m}var x=function(t){var n=t.target.result;p.forEach((function(e,t){return null!=e.error&&(y[t]=e.error)})),e({numFailures:v,failures:y,results:"delete"===i?o:p.map((function(e){return e.result})),lastResult:n})};h.onerror=function(e){m(e),x(e)},h.onsuccess=x}))},getMany:function(e){var n=e.trans,r=e.keys;return new Promise((function(e,i){e=He(e);for(var o,u=n.objectStore(t),a=r.length,s=new Array(a),c=0,l=0,f=function(t){var n=t.target;s[n._pos]=n.result,++l===c&&e(s)},h=rn(i),d=0;d<a;++d)null!=r[d]&&((o=u.get(r[d]))._pos=d,o.onsuccess=f,o.onerror=h,++c);0===c&&e(s)}))},get:function(e){var n=e.trans,r=e.key;return new Promise((function(e,i){e=He(e);var o=n.objectStore(t).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=rn(i)}))},query:function(e){return function(n){return new Promise((function(i,o){i=He(i);var u=n.trans,a=n.values,s=n.limit,c=n.query,l=s===1/0?void 0:s,f=c.index,h=c.range,d=u.objectStore(t),p=f.isPrimaryKey?d:d.index(f.name),y=r(h);if(0===s)return i({result:[]});if(e){var v=a?p.getAll(y,l):p.getAllKeys(y,l);v.onsuccess=function(e){return i({result:e.target.result})},v.onerror=rn(o)}else{var m=0,g=a||!("openKeyCursor"in p)?p.openCursor(y):p.openKeyCursor(y),b=[];g.onsuccess=function(e){var t=g.result;return t?(b.push(a?t.value:t.primaryKey),++m===s?i({result:b}):void t.continue()):i({result:b})},g.onerror=rn(o)}}))}}(a),openCursor:function(e){var n=e.trans,i=e.values,o=e.query,u=e.reverse,a=e.unique;return new Promise((function(e,s){e=He(e);var c=o.index,l=o.range,f=n.objectStore(t),h=c.isPrimaryKey?f:f.index(c.name),d=u?a?"prevunique":"prev":a?"nextunique":"next",p=i||!("openKeyCursor"in h)?h.openCursor(r(l),d):h.openKeyCursor(r(l),d);p.onerror=rn(s),p.onsuccess=He((function(t){var r=p.result;if(r){r.___id=++vn,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var u=r.advance.bind(r),a=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=He(s),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=He(e),p.onerror=rn(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=a,e(t)}})),n=function(){if(p.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=He((function(e){p.onsuccess=n,n()})),r.continue=i,r.continuePrimaryKey=o,r.advance=u,n(),t},e(r)}else e(null)}),s)}))},count:function(e){var n=e.query,i=e.trans,o=n.index,u=n.range;return new Promise((function(e,n){var a=i.objectStore(t),s=o.isPrimaryKey?a:a.index(o.name),c=r(u),l=c?s.count(c):s.count();l.onsuccess=He((function(t){return e(t.target.result)})),l.onerror=rn(n)}))}}}(e)})),c={};return s.forEach((function(e){return c[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!c[e])throw new Error("Table '"+e+"' not found");return c[e]},MIN_KEY:-1/0,MAX_KEY:dn(t),schema:u}}function bn(t,n,r,i){var o=r.IDBKeyRange;r.indexedDB;var u=function(t,n){return n.reduce((function(t,n){var r=n.create;return e(e({},t),r(t))}),t)}(gn(n,o,i),t.dbcore);return{dbcore:u}}function _n(e,t){var n=e._novip,r=t.db,i=bn(n._middlewares,r,n._deps,t);n.core=i.dbcore,n.tables.forEach((function(e){var t=e.name;n.core.schema.tables.some((function(e){return e.name===t}))&&(e.core=n.core.table(t),n[t]instanceof n.Table&&(n[t].core=e.core))}))}function wn(e,t,n,r){var i=e._novip;n.forEach((function(e){var n=r[e];t.forEach((function(t){var r=p(t,e);(!r||"value"in r&&void 0===r.value)&&(t===i.Transaction.prototype||t instanceof i.Transaction?f(t,e,{get:function(){return this.table(e)},set:function(t){l(this,e,{value:t,writable:!0,configurable:!0,enumerable:!0})}}):t[e]=new i.Table(e,n))}))}))}function xn(e,t){var n=e._novip;t.forEach((function(e){for(var t in e)e[t]instanceof n.Table&&delete e[t]}))}function kn(e,t){return e._cfg.version-t._cfg.version}function En(e,t,n,i){var o=e._dbSchema,u=e._createTransaction("readwrite",e._storeNames,o);u.create(n),u._completion.catch(i);var a=u._reject.bind(u),s=Ae.transless||Ae;tt((function(){Ae.trans=u,Ae.transless=s,0===t?(r(o).forEach((function(e){Kn(n,e,o[e].primKey,o[e].indexes)})),_n(e,n),Ie.follow((function(){return e.on.populate.fire(u)})).catch(a)):function(e,t,n,i){var o=e._novip,u=[],a=o._versions,s=o._dbSchema=Sn(o,o.idbdb,i),c=!1;function l(){return u.length?Ie.resolve(u.shift()(n.idbtrans)).then(l):Ie.resolve()}return a.filter((function(e){return e._cfg.version>=t})).forEach((function(e){u.push((function(){var u=s,a=e._cfg.dbschema;An(o,u,i),An(o,a,i),s=o._dbSchema=a;var l=Pn(u,a);l.add.forEach((function(e){Kn(i,e[0],e[1].primKey,e[1].indexes)})),l.change.forEach((function(e){if(e.recreate)throw new Z.Upgrade("Not yet support for changing primary key");var t=i.objectStore(e.name);e.add.forEach((function(e){return On(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),On(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var f=e._cfg.contentUpgrade;if(f&&e._cfg.version>t){_n(o,i),n._memoizedTables={},c=!0;var h=k(a);l.del.forEach((function(e){h[e]=u[e]})),xn(o,[o.Transaction.prototype]),wn(o,[o.Transaction.prototype],r(h),h),n.schema=h;var d,p=F(f);p&&nt();var y=Ie.follow((function(){if((d=f(n))&&p){var e=rt.bind(null,null);d.then(e,e)}}));return d&&"function"==typeof d.then?Ie.resolve(d):y.then((function(){return d}))}})),u.push((function(t){c&&Et||function(e,t){[].slice.call(t.db.objectStoreNames).forEach((function(n){return null==e[n]&&t.db.deleteObjectStore(n)}))}(e._cfg.dbschema,t);xn(o,[o.Transaction.prototype]),wn(o,[o.Transaction.prototype],o._storeNames,o._dbSchema),n.schema=o._dbSchema}))})),l().then((function(){var e,t;t=i,r(e=s).forEach((function(n){t.db.objectStoreNames.contains(n)||Kn(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,u,n).catch(a)}))}function Pn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var u={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!kt)u.recreate=!0,r.change.push(u);else{var a=i.idxByName,s=o.idxByName,c=void 0;for(c in a)s[c]||u.del.push(c);for(c in s){var l=a[c],f=s[c];l?l.src!==f.src&&u.change.push(f):u.add.push(f)}(u.del.length>0||u.add.length>0||u.change.length>0)&&r.change.push(u)}}else r.add.push([n,o])}return r}function Kn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return On(i,e)})),i}function On(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Sn(e,t,n){var r={};return v(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),i=t.keyPath,o=ln(fn(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),u=[],a=0;a<t.indexNames.length;++a){var s=t.index(t.indexNames[a]);i=s.keyPath;var c=ln(s.name,i,!!s.unique,!!s.multiEntry,!1,i&&"string"!=typeof i,!1);u.push(c)}r[e]=hn(e,o,u)})),r}function An(e,t,r){for(var i=e._novip,o=r.db.objectStoreNames,u=0;u<o.length;++u){var a=o[u],s=r.objectStore(a);i._hasGetAll="getAll"in s;for(var c=0;c<s.indexNames.length;++c){var l=s.indexNames[c],f=s.index(l).keyPath,h="string"==typeof f?f:"["+v(f).join("+")+"]";if(t[a]){var d=t[a].idxByName[h];d&&(d.name=l,delete t[a].idxByName[h],t[a].idxByName[l]=d)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&n.WorkerGlobalScope&&n instanceof n.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(i._hasGetAll=!1)}var Cn=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){r(e).forEach((function(n){if(null!==e[n]){var r=e[n].split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return ln(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),i(r),0===t)})),o=r.shift();if(o.multi)throw new Z.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new Z.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Z.Schema("Index must have a name and cannot be an empty string")})),t[n]=hn(n,o,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?o(this._cfg.storesSource,e):e;var n=t._versions,i={},u={};return n.forEach((function(e){o(i,e._cfg.storesSource),u=e._cfg.dbschema={},e._parseStoresSpec(i,u)})),t._dbSchema=u,xn(t,[t._allTables,t,t.Transaction.prototype]),wn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],r(u),u),t._storeNames=r(u),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=le(this._cfg.contentUpgrade||ne,e),this},e}();function jn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new rr(Ot,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function Dn(e){return e&&"function"==typeof e.databases}function In(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Dn(n)&&t!==Ot&&jn(n,r).delete(t).catch(ne)}function Bn(e){return tt((function(){return Ae.letThrough=!0,e()}))}function Tn(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function Rn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?yt(t.dbOpenError):e}));M&&(t.openCanceller._stackHolder=U()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller;function o(){if(t.openCanceller!==i)throw new Z.DatabaseClosed("db.open() was cancelled")}var u=t.dbReadyResolve,a=null,s=!1;return Ie.race([i,("undefined"==typeof navigator?Ie.resolve():Tn()).then((function(){return new Ie((function(i,u){if(o(),!n)throw new Z.MissingAPI;var c=e.name,l=t.autoSchema?n.open(c):n.open(c,Math.round(10*e.verno));if(!l)throw new Z.MissingAPI;l.onerror=rn(u),l.onblocked=He(e._fireOnBlocked),l.onupgradeneeded=He((function(r){if(a=l.transaction,t.autoSchema&&!e._options.allowEmptyDB){l.onerror=on,a.abort(),l.result.close();var i=n.deleteDatabase(c);i.onsuccess=i.onerror=He((function(){u(new Z.NoSuchDatabase("Database "+c+" doesnt exist"))}))}else{a.onerror=rn(u);var o=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;s=o<1,e._novip.idbdb=l.result,En(e,o/10,a,u)}}),u),l.onsuccess=He((function(){a=null;var n,o=e._novip.idbdb=l.result,u=v(o.objectStoreNames);if(u.length>0)try{var f=o.transaction(1===(n=u).length?n[0]:n,"readonly");t.autoSchema?function(e,t,n){var i=e._novip;i.verno=t.version/10;var o=i._dbSchema=Sn(0,t,n);i._storeNames=v(t.objectStoreNames,0),wn(i,[i._allTables],r(o),o)}(e,o,f):(An(e,e._dbSchema,f),function(e,t){var n=Pn(Sn(0,e.idbdb,t),e._dbSchema);n.add.length||n.change.some((function(e){return e.add.length||e.change.length}))}(e,f)),_n(e,f)}catch(e){}xt.push(e),o.onversionchange=He((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),o.onclose=He((function(t){e.on("close").fire(t)})),s&&function(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Dn(n)&&t!==Ot&&jn(n,r).put({name:t}).catch(ne)}(e._deps,c),i()}),u)}))}))]).then((function(){return o(),t.onReadyBeingFired=[],Ie.resolve(Bn((function(){return e.on.ready.fire(e.vip)}))).then((function n(){if(t.onReadyBeingFired.length>0){var r=t.onReadyBeingFired.reduce(le,ne);return t.onReadyBeingFired=[],Ie.resolve(Bn((function(){return r(e.vip)}))).then(n)}}))})).finally((function(){t.onReadyBeingFired=null,t.isBeingOpened=!1})).then((function(){return e})).catch((function(n){t.dbOpenError=n;try{a&&a.abort()}catch(e){}return i===t.openCanceller&&e._close(),yt(n)})).finally((function(){t.openComplete=!0,u()}))}function Fn(e){var t=function(t){return e.next(t)},n=o(t),r=o((function(t){return e.throw(t)}));function o(e){return function(t){var o=e(t),u=o.value;return o.done?u:u&&"function"==typeof u.then?u.then(n,r):i(u)?Promise.all(u).then(n,r):n(u)}}return o(t)()}function Mn(e,t,n){var r=arguments.length;if(r<2)throw new Z.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var o=P(i);return[e,o,n]}function Nn(e,t,n,r,i){return Ie.resolve().then((function(){var o=Ae.transless||Ae,u=e._createTransaction(t,n,e._dbSchema,r),a={trans:u,transless:o};if(r)u.idbtrans=r.idbtrans;else try{u.create(),e._state.PR1398_maxLoop=3}catch(r){return r.name===J.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(e._close(),e.open().then((function(){return Nn(e,t,n,null,i)}))):yt(r)}var s,c=F(i);c&&nt();var l=Ie.follow((function(){if(s=i.call(u,u))if(c){var e=rt.bind(null,null);s.then(e,e)}else"function"==typeof s.next&&"function"==typeof s.throw&&(s=Fn(s))}),a);return(s&&"function"==typeof s.then?Ie.resolve(s).then((function(e){return u.active?e:yt(new Z.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return s}))).then((function(e){return r&&u._resolve(),u._completion.then((function(){return e}))})).catch((function(e){return u._reject(e),yt(e)}))}))}function qn(e,t,n){for(var r=i(e)?e.slice():[e],o=0;o<n;++o)r.push(t);return r}var Ln={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return e(e({},t),{table:function(n){var r=t.table(n),i=r.schema,o={},u=[];function a(t,n,r){var i=mn(t),s=o[i]=o[i]||[],c=null==t?0:"string"==typeof t?1:t.length,l=n>0,f=e(e({},r),{isVirtual:l,keyTail:n,keyLength:c,extractKey:pn(t),unique:!l&&r.unique});(s.push(f),f.isPrimaryKey||u.push(f),c>1)&&a(2===c?t[0]:t.slice(0,c-1),n+1,r);return s.sort((function(e,t){return e.keyTail-t.keyTail})),f}var s=a(i.primaryKey.keyPath,0,i.primaryKey);o[":id"]=[s];for(var c=0,l=i.indexes;c<l.length;c++){var f=l[c];a(f.keyPath,0,f)}function h(n){var r,i,o=n.query.index;return o.isVirtual?e(e({},n),{query:{index:o,range:(r=n.query.range,i=o.keyTail,{type:1===r.type?2:r.type,lower:qn(r.lower,r.lowerOpen?t.MAX_KEY:t.MIN_KEY,i),lowerOpen:!0,upper:qn(r.upper,r.upperOpen?t.MIN_KEY:t.MAX_KEY,i),upperOpen:!0})}}):n}var d=e(e({},r),{schema:e(e({},i),{primaryKey:s,indexes:u,getIndexByKeyPath:function(e){var t=o[mn(e)];return t&&t[0]}}),count:function(e){return r.count(h(e))},query:function(e){return r.query(h(e))},openCursor:function(e){var n=e.query.index,i=n.keyTail,o=n.isVirtual,u=n.keyLength;if(!o)return r.openCursor(e);return r.openCursor(h(e)).then((function(n){return n&&function(n){var r=Object.create(n,{continue:{value:function(r){null!=r?n.continue(qn(r,e.reverse?t.MAX_KEY:t.MIN_KEY,i)):e.unique?n.continue(n.key.slice(0,u).concat(e.reverse?t.MIN_KEY:t.MAX_KEY,i)):n.continue()}},continuePrimaryKey:{value:function(e,r){n.continuePrimaryKey(qn(e,t.MAX_KEY,i),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===u?e[0]:e.slice(0,u)}},value:{get:function(){return n.value}}});return r}(n)}))}});return d}})}};function Un(e,t,n,i){return n=n||{},i=i||"",r(e).forEach((function(r){if(s(t,r)){var o=e[r],u=t[r];if("object"==typeof o&&"object"==typeof u&&o&&u){var a=D(o);a!==D(u)?n[i+r]=t[r]:"Object"===a?Un(o,u,n,i+r+"."):o!==u&&(n[i+r]=t[r])}else o!==u&&(n[i+r]=t[r])}else n[i+r]=void 0})),r(t).forEach((function(r){s(e,r)||(n[i+r]=t[r])})),n}var Vn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return e(e({},n),{table:function(r){var i=n.table(r),o=i.schema.primaryKey,u=e(e({},i),{mutate:function(n){var u=Ae.trans,a=u.table(r).hook,c=a.deleting,l=a.creating,f=a.updating;switch(n.type){case"add":if(l.fire===ne)break;return u._promise("readwrite",(function(){return h(n)}),!0);case"put":if(l.fire===ne&&f.fire===ne)break;return u._promise("readwrite",(function(){return h(n)}),!0);case"delete":if(c.fire===ne)break;return u._promise("readwrite",(function(){return h(n)}),!0);case"deleteRange":if(c.fire===ne)break;return u._promise("readwrite",(function(){return function(e){return d(e.trans,e.range,1e4)}(n)}),!0)}return i.mutate(n);function h(n){var r=Ae.trans,u=n.keys||function(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}(o,n);if(!u)throw new Error("Keys missing");return"delete"!==(n="add"===n.type||"put"===n.type?e(e({},n),{keys:u}):e({},n)).type&&(n.values=t([],n.values,!0)),n.keys&&(n.keys=t([],n.keys,!0)),function(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}(i,n,u).then((function(e){var t=u.map((function(t,i){var u=e[i],a={onerror:null,onsuccess:null};if("delete"===n.type)c.fire.call(a,t,u,r);else if("add"===n.type||void 0===u){var h=l.fire.call(a,t,n.values[i],r);null==t&&null!=h&&(t=h,n.keys[i]=t,o.outbound||x(n.values[i],o.keyPath,t))}else{var d=Un(u,n.values[i]),p=f.fire.call(a,d,t,u,r);if(p){var y=n.values[i];Object.keys(p).forEach((function(e){s(y,e)?y[e]=p[e]:x(y,e,p[e])}))}}return a}));return i.mutate(n).then((function(r){for(var i=r.failures,o=r.results,a=r.numFailures,s=r.lastResult,c=0;c<u.length;++c){var l=o?o[c]:u[c],f=t[c];null==l?f.onerror&&f.onerror(i[c]):f.onsuccess&&f.onsuccess("put"===n.type&&e[c]?n.values[c]:l)}return{failures:i,results:o,numFailures:a,lastResult:s}})).catch((function(e){return t.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}function d(t,n,r){return i.query({trans:t,values:!1,query:{index:o,range:n},limit:r}).then((function(i){var o=i.result;return h({type:"delete",keys:o,trans:t}).then((function(i){return i.numFailures>0?Promise.reject(i.failures[0]):o.length<r?{failures:[],numFailures:0,lastResult:void 0}:d(t,e(e({},n),{lower:o[o.length-1],lowerOpen:!0}),r)}))}))}}});return u}})}};function Wn(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)0===Vt(t.keys[i],e[o])&&(r.push(n?A(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch(e){return null}}var zn,Yn={stack:"dbcore",level:-1,create:function(t){return{table:function(n){var r=t.table(n);return e(e({},r),{getMany:function(e){if(!e.cache)return r.getMany(e);var t=Wn(e.keys,e.trans._cache,"clone"===e.cache);return t?Ie.resolve(t):r.getMany(e).then((function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?A(t):t},t}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),r.mutate(e)}})}}}};function Gn(e){return!("from"in e)}var Hn=function(e,t){if(!this){var n=new Hn;return e&&"d"in e&&o(n,e),n}o(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function Qn(e,t,n){var r=Vt(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(Gn(e))return o(e,{from:t,to:n,d:1});var i=e.l,u=e.r;if(Vt(n,e.from)<0)return i?Qn(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Zn(e);if(Vt(t,e.to)>0)return u?Qn(u,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Zn(e);Vt(t,e.from)<0&&(e.from=t,e.l=null,e.d=u?u.d+1:1),Vt(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var a=!e.r;i&&!e.l&&Xn(e,i),u&&a&&Xn(e,u)}}function Xn(e,t){Gn(t)||function e(t,n){var r=n.from,i=n.to,o=n.l,u=n.r;Qn(t,r,i),o&&e(t,o),u&&e(t,u)}(e,t)}function Jn(e,t){var n=$n(t),r=n.next();if(r.done)return!1;for(var i=r.value,o=$n(e),u=o.next(i.from),a=u.value;!r.done&&!u.done;){if(Vt(a.from,i.to)<=0&&Vt(a.to,i.from)>=0)return!0;Vt(i.from,a.from)<0?i=(r=n.next(a.from)).value:a=(u=o.next(i.from)).value}return!1}function $n(e){var t=Gn(e)?null:{s:0,n:e};return{next:function(e){for(var n=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Vt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Vt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Zn(t){var n,r,i=((null===(n=t.r)||void 0===n?void 0:n.d)||0)-((null===(r=t.l)||void 0===r?void 0:r.d)||0),o=i>1?"r":i<-1?"l":"";if(o){var u="r"===o?"l":"r",a=e({},t),s=t[o];t.from=s.from,t.to=s.to,t[o]=s[o],a[o]=s[u],t[u]=a,a.d=er(a)}t.d=er(t)}function er(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}c(Hn.prototype,(zn={add:function(e){return Xn(this,e),this},addKey:function(e){return Qn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach((function(e){return Qn(t,e,e)})),this}},zn[I]=function(){return $n(this)},zn));var tr={stack:"dbcore",level:0,create:function(t){var n=t.schema.name,o=new Hn(t.MIN_KEY,t.MAX_KEY);return e(e({},t),{table:function(u){var a=t.table(u),s=a.schema,c=s.primaryKey,l=c.extractKey,f=c.outbound,h=e(e({},a),{mutate:function(e){var t=e.trans,r=t.mutatedParts||(t.mutatedParts={}),c=function(e){var t="idb://"+n+"/"+u+"/"+e;return r[t]||(r[t]=new Hn)},l=c(""),f=c(":dels"),h=e.type,d="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[[],e.values]:[],p=d[0],y=d[1],v=e.trans._cache;return a.mutate(e).then((function(e){if(i(p)){"delete"!==h&&(p=e.results),l.addKeys(p);var t=Wn(p,v);t||"add"===h||f.addKeys(p),(t||y)&&function(e,t,n,r){function o(t){var o=e(t.name||"");function u(e){return null!=e?t.extractKey(e):null}var a=function(e){return t.multiEntry&&i(e)?e.forEach((function(e){return o.addKey(e)})):o.addKey(e)};(n||r).forEach((function(e,t){var i=n&&u(n[t]),o=r&&u(r[t]);0!==Vt(i,o)&&(null!=i&&a(i),null!=o&&a(o))}))}t.indexes.forEach(o)}(c,s,t,y)}else if(p){var n={from:p.lower,to:p.upper};f.add(n),l.add(n)}else l.add(o),f.add(o),s.indexes.forEach((function(e){return c(e.name).add(o)}));return e}))}}),d=function(e){var n,r,i=e.query,o=i.index,u=i.range;return[o,new Hn(null!==(n=u.lower)&&void 0!==n?n:t.MIN_KEY,null!==(r=u.upper)&&void 0!==r?r:t.MAX_KEY)]},p={get:function(e){return[c,new Hn(e.key)]},getMany:function(e){return[c,(new Hn).addKeys(e.keys)]},count:d,query:d,openCursor:d};return r(p).forEach((function(t){h[t]=function(r){var i=Ae.subscr;if(i){var s=function(e){var t="idb://"+n+"/"+u+"/"+e;return i[t]||(i[t]=new Hn)},c=s(""),h=s(":dels"),d=p[t](r),y=d[0],v=d[1];if(s(y.name||"").add(v),!y.isPrimaryKey){if("count"!==t){var m="query"===t&&f&&r.values&&a.query(e(e({},r),{values:!1}));return a[t].apply(this,arguments).then((function(e){if("query"===t){if(f&&r.values)return m.then((function(t){var n=t.result;return c.addKeys(n),e}));var n=r.values?e.result.map(l):e.result;r.values?c.addKeys(n):h.addKeys(n)}else if("openCursor"===t){var i=e,o=r.values;return i&&Object.create(i,{key:{get:function(){return h.addKey(i.primaryKey),i.key}},primaryKey:{get:function(){var e=i.primaryKey;return h.addKey(e),e}},value:{get:function(){return o&&c.addKey(i.primaryKey),i.value}}})}return e}))}h.add(o)}}return a[t].apply(this,arguments)}})),h}})}};var nr,rr=function(){function t(n,r){var i=this;this._middlewares={},this.verno=0;var o=t.dependencies;this._options=r=e({addons:t.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var u=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ne,dbReadyPromise:null,cancelOpen:ne,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};s.dbReadyPromise=new Ie((function(e){s.dbReadyResolve=e})),s.openCanceller=new Ie((function(e,t){s.cancelOpen=t})),this._state=s,this.name=n,this.on=Bt(this,"populate","blocked","versionchange","close",{ready:[le,ne]}),this.on.ready.subscribe=m(this.on.ready.subscribe,(function(e){return function(n,r){t.vip((function(){var t=i._state;if(t.openComplete)t.dbOpenError||Ie.resolve().then(n),r&&e(n);else if(t.onReadyBeingFired)t.onReadyBeingFired.push(n),r&&e(n);else{e(n);var o=i;r||e((function e(){o.on.ready.unsubscribe(n),o.on.ready.unsubscribe(e)}))}}))}})),this.Collection=(a=this,Tt(Yt.prototype,(function(e,t){this.db=a;var n=jt,r=null;if(t)try{n=t()}catch(e){r=e}var i=e._ctx,o=i.table,u=o.hook.reading.fire;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:u!==re?u:null}}))),this.Table=function(e){return Tt(It.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Bt(null,{creating:[ue,ne],reading:[ie,re],updating:[se,ne],deleting:[ae,ne]})}))}(this),this.Transaction=function(e){return Tt(cn.prototype,(function(t,n,r,i,o){var u=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=Bt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ie((function(e,t){u._resolve=e,u._reject=t})),this._completion.then((function(){u.active=!1,u.on.complete.fire()}),(function(e){var t=u.active;return u.active=!1,u.on.error.fire(e),u.parent?u.parent._reject(e):t&&u.idbtrans&&u.idbtrans.abort(),yt(e)}))}))}(this),this.Version=function(e){return Tt(Cn.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return Tt(nn.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};var i=e._deps.indexedDB;if(!i)throw new Z.MissingAPI;this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(e,t){return i.cmp(t,e)},this._max=function(e,t){return i.cmp(e,t)>0?e:t},this._min=function(e,t){return i.cmp(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(e){e.newVersion,i.close()})),this.on("blocked",(function(e){!e.newVersion||(e.newVersion,e.oldVersion)})),this._maxKey=dn(r.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new i.Transaction(e,t,n,i._options.chromeTransactionDurability,r)},this._fireOnBlocked=function(e){i.on("blocked").fire(e),xt.filter((function(e){return e.name===i.name&&e!==i&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(Ln),this.use(Vn),this.use(tr),this.use(Yn),this.vip=Object.create(this,{_vip:{value:!0}}),u.forEach((function(e){return e(i)}))}return t.prototype.version=function(e){if(isNaN(e)||e<.1)throw new Z.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Z.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(kn),n.stores({}),this._state.autoSchema=!1,n)},t.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||Ae.letThrough||this._vip)?e():new Ie((function(e,n){if(t._state.openComplete)return n(new Z.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void n(new Z.DatabaseClosed);t.open().catch(ne)}t._state.dbReadyPromise.then(e,n)})).then(e)},t.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:n,level:null==r?10:r,name:i}),o.sort((function(e,t){return e.level-t.level})),this},t.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},t.prototype.open=function(){return Rn(this)},t.prototype._close=function(){var e=this._state,t=xt.indexOf(this);if(t>=0&&xt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this._novip.idbdb=null}e.dbReadyPromise=new Ie((function(t){e.dbReadyResolve=t})),e.openCanceller=new Ie((function(t,n){e.cancelOpen=n}))},t.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new Z.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},t.prototype.delete=function(){var e=this,t=arguments.length>0,n=this._state;return new Ie((function(r,i){var o=function(){e.close();var t=e._deps.indexedDB.deleteDatabase(e.name);t.onsuccess=He((function(){In(e._deps,e.name),r()})),t.onerror=rn(i),t.onblocked=e._fireOnBlocked};if(t)throw new Z.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(o):o()}))},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return null!==this.idbdb},t.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},t.prototype.hasFailed=function(){return null!==this._state.dbOpenError},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var e=this;return r(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!1,configurable:!0}),t.prototype.transaction=function(){var e=Mn.apply(this,arguments);return this._transaction.apply(this,e)},t.prototype._transaction=function(e,t,n){var r=this,i=Ae.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,u,a=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(u=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||e===St)o=St;else{if("rw"!=e&&e!=At)throw new Z.InvalidArgument("Invalid transaction mode: "+e);o=At}if(i){if(i.mode===St&&o===At){if(!a)throw new Z.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&u.forEach((function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!a)throw new Z.SubTransaction("Table "+e+" not included in parent transaction.");i=null}})),a&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,(function(t,n){n(e)})):yt(e)}var s=Nn.bind(null,this,o,u,i,n);return i?i._promise(o,s,"lock"):Ae.trans?ct(Ae.transless,(function(){return r._whenReady(s)})):this._whenReady(s)},t.prototype.table=function(e){if(!s(this._allTables,e))throw new Z.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},t}(),ir="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",or=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},e.prototype[ir]=function(){return this},e}();function ur(e,t){return r(t).forEach((function(n){Xn(e[n]||(e[n]=new Hn),t[n])})),e}function ar(e){var t=!1,n=void 0,i=new or((function(i){var o=F(e);var u=!1,a={},s={},c={get closed(){return u},unsubscribe:function(){u=!0,sn.storagemutated.unsubscribe(d)}};i.start&&i.start(c);var l=!1,f=!1;function h(){return r(s).some((function(e){return a[e]&&Jn(a[e],s[e])}))}var d=function(e){ur(a,e),h()&&p()},p=function(){if(!l&&!u){a={};var r={},y=function(t){o&&nt();var n=function(){return tt(e,{subscr:t,trans:null})},r=Ae.trans?ct(Ae.transless,n):n();return o&&r.then(rt,rt),r}(r);f||(sn(un,d),f=!0),l=!0,Promise.resolve(y).then((function(e){t=!0,n=e,l=!1,u||(h()?p():(a={},s=r,i.next&&i.next(e)))}),(function(e){l=!1,t=!1,i.error&&i.error(e),c.unsubscribe()}))}};return p(),c}));return i.hasValue=function(){return t},i.getValue=function(){return n},i}try{nr={indexedDB:n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB,IDBKeyRange:n.IDBKeyRange||n.webkitIDBKeyRange}}catch(e){nr={indexedDB:null,IDBKeyRange:null}}var sr=rr;function cr(e){var t=lr;try{lr=!0,sn.storagemutated.fire(e)}finally{lr=t}}c(sr,e(e({},te),{delete:function(e){return new sr(e,{addons:[]}).delete()},exists:function(e){return new sr(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return function(e){var t=e.indexedDB,n=e.IDBKeyRange;return Dn(t)?Promise.resolve(t.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==Ot}))})):jn(t,n).toCollection().primaryKeys()}(sr.dependencies).then(e)}catch(e){return yt(new Z.MissingAPI)}},defineClass:function(){return function(e){o(this,e)}},ignoreTransaction:function(e){return Ae.trans?ct(Ae.transless,e):e()},vip:Bn,async:function(e){return function(){try{var t=Fn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Ie.resolve(t)}catch(e){return yt(e)}}},spawn:function(e,t,n){try{var r=Fn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Ie.resolve(r)}catch(e){return yt(e)}},currentTransaction:{get:function(){return Ae.trans||null}},waitFor:function(e,t){var n=Ie.resolve("function"==typeof e?sr.ignoreTransaction(e):e).timeout(t||6e4);return Ae.trans?Ae.trans.waitFor(n):n},Promise:Ie,debug:{get:function(){return M},set:function(e){N(e,"dexie"===e?function(){return!0}:Kt)}},derive:h,extend:o,props:c,override:m,Events:Bt,on:sn,liveQuery:ar,extendObservabilitySet:ur,getByKeyPath:w,setByKeyPath:x,delByKeyPath:function(e,t){"string"==typeof t?x(e,t,void 0):"length"in t&&[].map.call(t,(function(t){x(e,t,void 0)}))},shallowClone:k,deepClone:A,getObjectDiff:Un,cmp:Vt,asap:b,minKey:bt,addons:[],connections:xt,errnames:J,dependencies:nr,semVer:mt,version:mt.split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)}))})),sr.maxKey=dn(sr.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(sn(un,(function(e){var t;lr||(kt?(t=document.createEvent("CustomEvent")).initCustomEvent(an,!0,!0,e):t=new CustomEvent(an,{detail:e}),lr=!0,dispatchEvent(t),lr=!1)})),addEventListener(an,(function(e){var t=e.detail;lr||cr(t)})));var lr=!1;if("undefined"!=typeof BroadcastChannel){var fr=new BroadcastChannel(an);"function"==typeof fr.unref&&fr.unref(),sn(un,(function(e){lr||fr.postMessage(e)})),fr.onmessage=function(e){e.data&&cr(e.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){sn(un,(function(e){try{lr||("undefined"!=typeof localStorage&&localStorage.setItem(an,JSON.stringify({trig:Math.random(),changedParts:e})),"object"==typeof self.clients&&t([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach((function(t){return t.postMessage({type:an,changedParts:e})})))}catch(e){}})),"undefined"!=typeof addEventListener&&addEventListener("storage",(function(e){if(e.key===an){var t=JSON.parse(e.newValue);t&&cr(t.changedParts)}}));var hr=self.document&&navigator.serviceWorker;hr&&hr.addEventListener("message",(function(e){var t=e.data;t&&t.type===an&&cr(t.changedParts)}))}return Ie.rejectionMapper=function(e,t){if(!e||e instanceof G||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ee[e.name])return e;var n=new ee[e.name](t||e.message,e);return"stack"in e&&f(n,"stack",{get:function(){return this.inner.stack}}),n},N(M,Kt),e(rr,Object.freeze({__proto__:null,Dexie:rr,liveQuery:ar,default:rr,RangeSet:Hn,mergeRanges:Xn,rangesOverlap:Jn}),{default:rr}),rr}));